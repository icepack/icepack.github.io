

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Synthetic ice stream &mdash; icepack 0.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Inverse problems" href="icepack.demo.04-ice-shelf-inverse.html" />
    <link rel="prev" title="Larsen Ice Shelf" href="icepack.demo.02-larsen-ice-shelf.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> icepack
          

          
          </a>

          
            
            
              <div class="version">
                0.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.00-meshes-functions.html">Meshes, functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.01-synthetic-ice-shelf.html">Synthetic ice shelf</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.02-larsen-ice-shelf.html">Larsen Ice Shelf</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Synthetic ice stream</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#geometry-and-input-data">Geometry and input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modeling">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recap">Recap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#changing-the-model-physics">Changing the model physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-schoof-sliding-law">The Schoof sliding law</a></li>
<li class="toctree-l2"><a class="reference internal" href="#response-to-perturbations">Response to perturbations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.04-ice-shelf-inverse.html">Inverse problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.05-hybrid-ice-stream.html">Ice streams, once more</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">icepack</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">icepack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Synthetic ice stream</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/icepack.demo.03-synthetic-ice-stream.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tqdm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">firedrake</span>
<span class="kn">from</span> <span class="nn">firedrake</span> <span class="kn">import</span> <span class="n">inner</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">icepack</span><span class="o">,</span> <span class="nn">icepack.plot</span>
</pre></div>
</div>
<div class="section" id="synthetic-ice-stream">
<h1>Synthetic ice stream<a class="headerlink" href="#synthetic-ice-stream" title="Permalink to this headline">¶</a></h1>
<p>In this demo, we’ll simulate the evolution of an ice stream with both
grounded and floating parts. Ice streams are substantially more
complicated than a floating ice shelf. First, there are more fields. For
floating ice shelves, we only had to consider the velocity, thickness,
and fluidity, but for ice streams there’s also the surface elevation and
bed friction. Second, the position of the grounded line – the contour
across which the glacier is thin enough to go afloat – can migrate in
time.</p>
<p>The diagnostic equation for an ice stream is similar to that of a
floating ice shelf, but for the addition of a term for basal friction:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot hM - C|u|^{1/m - 1}u - \rho gh\nabla s = 0,\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the <em>sliding exponent</em> and <span class="math notranslate nohighlight">\(C\)</span> is the <em>sliding
coefficient</em>.</p>
<p>The glacier state we’ll start out with is grounded throughout the entire
domain, and during the simulation it will thin out and go afloat part
way through. Accurately predicting grounding line migration is a major
problem in glacier flow modeling.</p>
<div class="section" id="geometry-and-input-data">
<h2>Geometry and input data<a class="headerlink" href="#geometry-and-input-data" title="Permalink to this headline">¶</a></h2>
<p>We’ll use an elongated fjord-like geometry, 12 km wide and 50 km from
the inflow boundary to the ice front. The bedrock slopes down from 200 m
above sea level at the inflow boundary to -400 m at the terminus; the
glacier becomes marine one third of the way into the domain.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mf">50e3</span><span class="p">,</span> <span class="mf">12e3</span>
<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">RectangleMesh</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="n">b_in</span><span class="p">,</span> <span class="n">b_out</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">400</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">b_in</span> <span class="o">-</span> <span class="p">(</span><span class="n">b_in</span> <span class="o">-</span> <span class="n">b_out</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="n">s_in</span><span class="p">,</span> <span class="n">s_out</span> <span class="o">=</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">s0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">s_in</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_in</span> <span class="o">-</span> <span class="n">s_out</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="n">h0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">s0</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
<p>As a sanity check, we’ll evaluate the driving stress</p>
<div class="math notranslate nohighlight">
\[\tau_D = -\rho_Igh\nabla s\]</div>
<p>at the inflow boundary of the ice stream to make sure the value isn’t
absurd.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">icepack.constants</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ice_density</span> <span class="k">as</span> <span class="n">ρ_I</span><span class="p">,</span>
    <span class="n">water_density</span> <span class="k">as</span> <span class="n">ρ_W</span><span class="p">,</span>
    <span class="n">gravity</span> <span class="k">as</span> <span class="n">g</span>
<span class="p">)</span>

<span class="n">h_in</span> <span class="o">=</span> <span class="n">s_in</span> <span class="o">-</span> <span class="n">b_in</span>
<span class="n">δs_δx</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_out</span> <span class="o">-</span> <span class="n">s_in</span><span class="p">)</span> <span class="o">/</span> <span class="n">Lx</span>
<span class="n">τ_D</span> <span class="o">=</span> <span class="o">-</span><span class="n">ρ_I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h_in</span> <span class="o">*</span> <span class="n">δs_δx</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> kPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">τ_D</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">93.556008</span> <span class="n">kPa</span>
</pre></div>
</div>
<p>This stress is on the moderate side for Greenland, high for Antarctica.</p>
<p>Next we have to come up with some rough guess for the initial velocity
of the glacier. Unlike for ice shelves, we can’t write down an exact
solution for the velocity. Our best hope is to come up with something
vaguely reasonable and tune it by trial and error until we get something
that isn’t ridiculous.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_in</span><span class="p">,</span> <span class="n">u_out</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2400</span>
<span class="n">velocity_x</span> <span class="o">=</span> <span class="n">u_in</span> <span class="o">+</span> <span class="p">(</span><span class="n">u_out</span> <span class="o">-</span> <span class="n">u_in</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">Lx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">firedrake</span><span class="o">.</span><span class="n">as_vector</span><span class="p">((</span><span class="n">velocity_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">255.0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">icepack</span><span class="o">.</span><span class="n">rate_factor</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
<p>Now to pick a friction coefficient. We’ll use a value of the friction
that almost exactly balances the driving stress at the inflow boundary.
Where the glacier goes marine, we’ll scale the friction down acoording
to the height above flotation. This is a very rough approximation. The
point is to scale the friction down continuously as the glacier
approaches flotation. If we didn’t take care to ramp the friction down
and instead just set it to 0 where the ice is floating, we’d get a shock
to the system as the bed friction “turns off” across the grounding line.
For a realistic problem, you’d want to take greater account of how the
pressure of meltwater at the bed affects friction.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">icepack.constants</span> <span class="kn">import</span> <span class="n">weertman_sliding_law</span> <span class="k">as</span> <span class="n">m</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.95</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">x</span><span class="o">/</span><span class="n">Lx</span><span class="p">)</span> <span class="o">*</span> <span class="n">τ_D</span> <span class="o">/</span> <span class="n">u_in</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>

<span class="n">p_W</span> <span class="o">=</span> <span class="n">ρ_W</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h0</span> <span class="o">-</span> <span class="n">s0</span><span class="p">)</span>
<span class="n">p_I</span> <span class="o">=</span> <span class="n">ρ_I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h0</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_W</span> <span class="o">/</span> <span class="n">p_I</span>
</pre></div>
</div>
<p>In the previous examples, we’ve initialized a model object and then used
it directly to compute velocities and thicknesses. These model objects
have sensible defaults for how the physics are parameterized. For
example, we pass in the ice fluidity coefficient <span class="math notranslate nohighlight">\(A\)</span>, which has
units of strain rate <span class="math notranslate nohighlight">\(\times\)</span> stress<span class="math notranslate nohighlight">\({}^{-3}\)</span>. We could
just as easily have used, say, the rheology coefficient
<span class="math notranslate nohighlight">\(B = A^{-1/n}\)</span>, where <span class="math notranslate nohighlight">\(n = 3\)</span> is the exponent in Glen’s flow
law. You can customize the physics parameterizations by passing in your
own Python functions for computing the action functional. The default in
the <code class="docutils literal notranslate"><span class="pre">IceStream</span></code> class is to take in a friction coefficient <span class="math notranslate nohighlight">\(C\)</span>,
but we also want to include the ramping factor, which depends on the ice
thickness and surface elevation. The following function works as a
wrapper around the default parameterization, multiplying the friction
coefficient by the ramping factor.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">icepack.models.friction</span>
<span class="k">def</span> <span class="nf">weertman_friction_with_ramp</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">]</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;thickness&#39;</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;friction&#39;</span><span class="p">]</span>

    <span class="n">p_W</span> <span class="o">=</span> <span class="n">ρ_W</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">p_I</span> <span class="o">=</span> <span class="n">ρ_I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h</span>
    <span class="n">ϕ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_W</span> <span class="o">/</span> <span class="n">p_I</span>
    <span class="k">return</span> <span class="n">icepack</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">friction</span><span class="o">.</span><span class="n">bed_friction</span><span class="p">(</span>
        <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
        <span class="n">friction</span><span class="o">=</span><span class="n">C</span> <span class="o">*</span> <span class="n">ϕ</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Now we can create a model object that uses our new parameterization by
passing it to the constructor for the <code class="docutils literal notranslate"><span class="pre">IceStream</span></code> class. We’re calling
the model object <code class="docutils literal notranslate"><span class="pre">model_weertman</span></code> because, at the end of this demo,
we’ll compare with something quite different – the Schoof model for
basal sliding. The solver object is created in the same way as before.
Customizing the physics changes what problem we’re solving, but the
algorithms that we use to approximate the solution are identical.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_weertman</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">IceStream</span><span class="p">(</span><span class="n">friction</span><span class="o">=</span><span class="n">weertman_friction_with_ramp</span><span class="p">)</span>
<span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dirichlet_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;side_wall_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;tolerance&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">}</span>
<span class="n">solver_weertman</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">solvers</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">model_weertman</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>

<span class="n">u0</span> <span class="o">=</span> <span class="n">solver_weertman</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
    <span class="n">velocity</span><span class="o">=</span><span class="n">u0</span><span class="p">,</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">h0</span><span class="p">,</span>
    <span class="n">surface</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span>
    <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span>
    <span class="n">friction</span><span class="o">=</span><span class="n">C</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_18_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_18_0.png" />
<p>Below we show some plots of the basal shear stress and the mass flux.
Note how the basal shear stress gets closer to 0 near the terminus
because of how we reduced the friction.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">τ_b</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">ϕ</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">inner</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">u0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">τ_b</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;kPa&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_20_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_20_0.png" />
<p>There’s a huge mass balance anomaly near the ice front, an artifact of
our choice of initial conditions. As the simulation progresses, this
initial transient should be propagated out of the domain.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="o">-</span><span class="n">div</span><span class="p">(</span><span class="n">h0</span> <span class="o">*</span> <span class="n">u0</span><span class="p">),</span> <span class="n">Q</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_22_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_22_0.png" />
</div>
<div class="section" id="modeling">
<h2>Modeling<a class="headerlink" href="#modeling" title="Permalink to this headline">¶</a></h2>
<p>Now the good part – taking our initial glacier state and projecting it
forward until it reaches a steady state. We’ll use a timestep of 6
months and the simulation will run for 250 model years. This is about
enough time to propagate out the initial transients and arrive at a
state of approximate mass and momentum balance. I’ve tuned the
accumulation rate so that it roughly balances out the ice flux at the
inflow boundary and is within the range of values one might see in
southeast Greenland.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_years</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">timesteps_per_year</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">δt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">timesteps_per_year</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="n">num_years</span> <span class="o">*</span> <span class="n">timesteps_per_year</span>

<span class="n">a_in</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">1.7</span><span class="p">)</span>
<span class="n">δa</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">2.7</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a_in</span> <span class="o">+</span> <span class="n">δa</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">h0</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">u0</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">trange</span><span class="p">(</span><span class="n">num_timesteps</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">solver_weertman</span><span class="o">.</span><span class="n">prognostic_solve</span><span class="p">(</span>
        <span class="n">δt</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
        <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
        <span class="n">accumulation</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
        <span class="n">thickness_inflow</span><span class="o">=</span><span class="n">h0</span>
    <span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">compute_surface</span><span class="p">(</span><span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">bed</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">solver_weertman</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
        <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
        <span class="n">surface</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
        <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span>
        <span class="n">friction</span><span class="o">=</span><span class="n">C</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100%|██████████| 500/500 [03:07&lt;00:00,  2.67it/s]
</pre></div>
</div>
<p>Notice that we have one extra step in the middle of the simulation loop.
For ice shelves, all we had to do was (1) update the thickness according
to the prognostic equation and then (2) compute the new ice velocity
corresponding to this thickness. Since ice shelves are floating, we can
calculate the surface elevation as a function of the ice thickness
knowing the densities of ice and ocean water, and this is baked into the
formulation of the problem. Ice streams, on the other hand, can be
grounded or floating. After we update the ice thickness, we need to
explicitly calculate a new surface elevation in a way that accounts for
whether the ice is floating or grounded, and that’s what the function
<code class="docutils literal notranslate"><span class="pre">icepack.compute_surface</span></code> does. Let’s see what the results look like.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span>  <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_26_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_26_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_27_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_27_0.png" />
<p>We can see by plotting the mass balance that the system is much closer
to equilibrium than it was at the start.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">div</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">u</span><span class="p">),</span> <span class="n">Q</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_29_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_29_0.png" />
<p>Finally, we can draw some transects through the domain to see what the
surface, bed, and ice base elevation look like in the
<span class="math notranslate nohighlight">\(x, z\)</span>-plane.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">Lx</span> <span class="o">*</span> <span class="n">k</span> <span class="o">/</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

<span class="n">ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>
<span class="n">hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>
<span class="n">bs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">ss</span> <span class="o">-</span> <span class="n">hs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;distance along centerline (km)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;elevation (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_31_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_31_0.png" />
<p>The glacier exhibits the typical drop in thickness gradient as it
crosses the grounding line.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">hs</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;distance along centerline (km)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;thickess (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_33_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_33_0.png" />
</div>
<div class="section" id="recap">
<h2>Recap<a class="headerlink" href="#recap" title="Permalink to this headline">¶</a></h2>
<p>The demonstration above shows how to simulate the evolution of a
grounded ice stream; while there are more fields to keep track of than
for a floating ice shelf, the basic principles are still the same.</p>
<p>Coming up with physically plausible synthetic test cases is difficult.
The variables that we can control are the bed geometry, the accumulation
rate, and the ice flux at inflow. To a certain extent, we can pick the
friction coefficient, but this can change in ways that are difficult to
predict as parts of the glacier begin to float. Our initial state was
far out of mass balance and we let it evolve towards equilibrium, but we
don’t know ahead of time what surface slope or stretching rate the
glacier will settle on in the end.</p>
<p>The eventual steady state could be physically implausible for reasons
that weren’t obvious from the start. For example, if the ice strain rate
increases beyond what we expect after a few years of model time, the
mass flux at the inflow boundary could be much larger than what the
influx and accumulation rate can supply, leading to an unphysically
sharp drop in the surface. Preparing this demonstration required lots of
trial and error to get the parameters just right, and that’s to be
expected.</p>
<p>The bed elevation we used sloped down towards the ocean; had we instead
used a bed elevation that sloped down going inland, the configuration
would be unstable due to marine ice sheet instability. An interesting
variation on this demo could be to use a bed geometry with several
stable pinning points, interspersed with unstable retrograde slopes.</p>
</div>
<div class="section" id="changing-the-model-physics">
<h2>Changing the model physics<a class="headerlink" href="#changing-the-model-physics" title="Permalink to this headline">¶</a></h2>
<p>In the first part of this demo, we used the usual Weertman sliding law,
where the basal shear stress is proportional to some power of the ice
sliding speed. Weertman sliding assumes that the glacier slides by
regelation. Where the glacier flows over deformable sediments, the
sliding relation could instead approach plasticity – the stress depends
only on the direction and not the magnitude of the velocity. Other
sliding laws have been proposed that exhibit this feature, for example
the law proposed in Schoof (2005), The effect of cavitation on glacier
sliding.</p>
<p>In icepack, all of the diagnostic model physics is prescribed through an
action principle. Rather than specify how the shear stress depends on
the ice velocity, we specify the frictional energy dissipation. The
stress is then the functional derivative of the dissipation with respect
to velocity. For the Weertman sliding law</p>
<div class="math notranslate nohighlight">
\[\tau_b = -C|u|^{\frac{1}{m} - 1}u,\]</div>
<p>the energy dissipation is</p>
<div class="math notranslate nohighlight">
\[E(u) = \int \frac{m}{m + 1}C|u|^{\frac{1}{m} + 1}dx.\]</div>
<p>In the first part of the demo, we showed how to slightly modify the
physics by adding a thickness- and elevation-dependent factor to reduce
the friction when the glacier bed is below sea level. In the following,
we’ll show how to use a completely different model of glacier sliding.</p>
</div>
<div class="section" id="the-schoof-sliding-law">
<h2>The Schoof sliding law<a class="headerlink" href="#the-schoof-sliding-law" title="Permalink to this headline">¶</a></h2>
<p>To modify the Weertman sliding law for high ice speeds, we need for the
energy dissipation density to be asymptotically like <span class="math notranslate nohighlight">\(|u|^1\)</span> for
large <span class="math notranslate nohighlight">\(u\)</span>, but like <span class="math notranslate nohighlight">\(|u|^{1/m + 1}\)</span> for small <span class="math notranslate nohighlight">\(u\)</span>.
“Small” and “large” will be defined relative to some reference or
threshold speed <span class="math notranslate nohighlight">\(U_0\)</span>. While it doesn’t exactly reproduce the
Schoof sliding law itself, the following functional gives the right
asymptotic behavior:</p>
<div class="math notranslate nohighlight">
\[E(u) = \int \tau_0\left(\left(U_0^{\frac{1}{m} + 1} + |u|^{\frac{1}{m} + 1}\right)^{\frac{m}{m + 1}} - U_0\right) dx\]</div>
<p>The extra factor of <span class="math notranslate nohighlight">\(-U_0\)</span> is there to make it so that
<span class="math notranslate nohighlight">\(E(0) = 0\)</span>, i.e. there is no dissipation when there is no flow.
The right value of <span class="math notranslate nohighlight">\(U_0\)</span> isn’t very well constrained. For this
demonstration, we’ll use a value of 50 m/year, since this falls roughly
in the middle of the grounded region for the final velocity. We’ll then
choose the value of the factor <span class="math notranslate nohighlight">\(\tau_0\)</span>, which has units of
stress, so that the stress is the same as the value at the end of the
simulation we’ve just run using Weertman sliding.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U_0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">inner</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>
<span class="n">τ_0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
    <span class="n">C</span> <span class="o">*</span> <span class="p">(</span><span class="n">U_0</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">U</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">Q</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">τ_0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_38_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_38_0.png" />
<p>The following function returns the kernel of the action functional
associated to this sliding law, given the ice velocity, elevation, and
the yield stress. Note that we only need to provide the inside of the
integral – the model object applies the measures (<code class="docutils literal notranslate"><span class="pre">dx</span></code>, <code class="docutils literal notranslate"><span class="pre">ds</span></code>, etc.)
for you.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">schoof_friction</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">]</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;thickness&#39;</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;surface&#39;</span><span class="p">]</span>
    <span class="n">τ_0</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yield_stress&#39;</span><span class="p">]</span>

    <span class="n">ϕ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ρ_W</span> <span class="o">/</span> <span class="n">ρ_I</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">inner</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">τ_0</span> <span class="o">*</span> <span class="n">ϕ</span> <span class="o">*</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">U_0</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">U</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">U_0</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Before we go on, let’s take a look at what the basal shear stress
actually looks like. Recall that the quantity we defined above is the
rate of free energy dissipation due to frictional stress. To get the
actual basal shear, we’ll take the derivative of this quantity with
respect to the velocity <span class="math notranslate nohighlight">\(u\)</span>. The analytical formula for the stress
is</p>
<div class="math notranslate nohighlight">
\[\tau = -\frac{\tau_0|u|^{\frac{1}{m} - 1}u}{\left(U_0^{\frac{1}{m} + 1} + |u|^{\frac{1}{m} + 1}\right)^{\frac{1}{m + 1}}}.\]</div>
<p>Observe how the magnitude of the basal shear is asymptotic to
<span class="math notranslate nohighlight">\(|u|^{1/m}\)</span> when <span class="math notranslate nohighlight">\(|u| \ll U_0\)</span>, but to <span class="math notranslate nohighlight">\(\tau_0\)</span> when
<span class="math notranslate nohighlight">\(|u| \gg U_0\)</span>.</p>
<p>To calculate the basal shear, we could painstakingly write out this
whole formula in Python. Or we could take advantage of the symbolic
differentiation features of the form language by first creating the free
energy dissipation <code class="docutils literal notranslate"><span class="pre">F</span></code> and then calling <code class="docutils literal notranslate"><span class="pre">firedrake.diff</span></code> on it.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">schoof_friction</span><span class="p">(</span><span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">yield_stress</span><span class="o">=</span><span class="n">τ_0</span><span class="p">)</span>
<span class="n">τ</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="o">-</span><span class="n">firedrake</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">u</span><span class="p">),</span> <span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">τ</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_43_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_43_0.png" />
<p>This matches up with what we expect – higher stress at the grounded
part of the ice stream, which then decreases to 0 towards the grounding
line.</p>
<p>Now we can create a new <code class="docutils literal notranslate"><span class="pre">IceStream</span></code> object that will use this function
to calculate the action rather than the usual Weertman sliding law:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_schoof</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">IceStream</span><span class="p">(</span><span class="n">friction</span><span class="o">=</span><span class="n">schoof_friction</span><span class="p">)</span>
</pre></div>
</div>
<p>The Schoof friction functional that we defined above takes in more
parameters than the usual Weertman law, but thanks to keyword arguments
in Python, everything gets passed to the right place despite this
change. Let’s do a diagnostic solve with this new model and see how
different it is from the velocity obtained with the Weertman sliding
law.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver_schoof</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">solvers</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">model_schoof</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">u_schoof</span> <span class="o">=</span> <span class="n">solver_schoof</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
    <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
    <span class="n">surface</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
    <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span>
    <span class="n">yield_stress</span><span class="o">=</span><span class="n">τ_0</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u_schoof</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_48_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_48_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">icepack</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_schoof</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">3.719305481370469e-10</span>
</pre></div>
</div>
<p>Just as we expect – the resulting velocities are practically the same.
We picked the parameters in the Schoof sliding law to give the same
basal shear stress as with the Weertman law, so we should get the same
velocity.</p>
</div>
<div class="section" id="response-to-perturbations">
<h2>Response to perturbations<a class="headerlink" href="#response-to-perturbations" title="Permalink to this headline">¶</a></h2>
<p>The steady state we’ve found is roughly an equilibrium for both the
Weertman and Schoof sliding laws. To conclude this demo, we’ll increase
the melt rate under the floating ice tongue and see how the system
responds. To perturb the system out of its current equilibrium state,
we’ll add an extra 1 m/year of melting in the right-hand side of the
domain. If we wanted to be more physically realistic about things, we
might set the melt rate to be a function of depth below sea level, or
even use a plume model.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firedrake</span> <span class="kn">import</span> <span class="n">conditional</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a_in</span> <span class="o">+</span> <span class="n">δa</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span> <span class="o">-</span> <span class="n">conditional</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">Lx</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>We’ll wrap up the same loop as we had before in a function that takes in
the model (Weertman or Schoof) as an argument. This saves a bit of
repetition and makes it easier to parallelize later.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_years</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">timesteps_per_year</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">δt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">timesteps_per_year</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="n">num_years</span> <span class="o">*</span> <span class="n">timesteps_per_year</span>

<span class="k">def</span> <span class="nf">run_simulation</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">trange</span><span class="p">(</span><span class="n">num_timesteps</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">prognostic_solve</span><span class="p">(</span>
            <span class="n">δt</span><span class="p">,</span>
            <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
            <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
            <span class="n">accumulation</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
            <span class="n">thickness_inflow</span><span class="o">=</span><span class="n">h0</span>
        <span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">compute_surface</span><span class="p">(</span><span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">bed</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
            <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
            <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
            <span class="n">surface</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">u</span>

<span class="n">h_weertman</span><span class="p">,</span> <span class="n">s_weertman</span><span class="p">,</span> <span class="n">u_weertman</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">solver_weertman</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">friction</span><span class="o">=</span><span class="n">C</span>
<span class="p">)</span>

<span class="n">h_schoof</span><span class="p">,</span> <span class="n">s_schoof</span><span class="p">,</span> <span class="n">u_schoof</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">solver_schoof</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">u_schoof</span><span class="p">,</span> <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">yield_stress</span><span class="o">=</span><span class="n">τ_0</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100%|██████████| 200/200 [00:53&lt;00:00,  3.75it/s]
100%|██████████| 200/200 [01:10&lt;00:00,  2.85it/s]
</pre></div>
</div>
<p>Finally, we’ll plot a transect of the difference in thickness between
the Weertman and Schoof laws. The glacier loses more mass over the
grounded region and less under the ice shelf with the Schoof law than
with the Weertman law. When the sliding relation becomes more plastic,
the bed can take up less of the increased driving stress resulting from
steeper surface slopes, so that changes under the ice shelf are evident
further upstream.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs_weertman</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_weertman</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>
<span class="n">hs_schoof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_schoof</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">hs_weertman</span> <span class="o">-</span> <span class="n">hs_schoof</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;distance along centerline (km)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;thickness difference (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.03-synthetic-ice-stream_56_0.png" src="_images/icepack.demo.03-synthetic-ice-stream_56_0.png" />
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>The Schoof sliding law is, arguably, more physically realistic than the
Weertman sliding law for fast-flowing outlet glaciers or ice streams.
While icepack defaults to using the Weertman sliding law, replacing it
with the Schoof law consists of only a few lines of code. First, we have
to write a function that calculates the energy dissipation from
Schoof-type sliding. We then have to pass this function to the
constructor of the <code class="docutils literal notranslate"><span class="pre">IceStream</span></code> model object we use to calculate the
ice velocity. By passing in all the input fields to the
<code class="docutils literal notranslate"><span class="pre">diagnostic_solve</span></code> method as keyword arguments, we don’t have to
rewrite or override any methods of <code class="docutils literal notranslate"><span class="pre">IceStream</span></code>, despite the fact that
there are more input fields to the Schoof sliding law than there are for
the Weertman law.</p>
<p>In switching to the Schoof sliding law, we showed how the physics could
be modified to take in a possibly arbitrary number of different fields
beyond the default physics parameterization. These additional fields
could themselves be computed by solving other PDEs. For example, we
could define the basal shear stress to be a function of the effective
water pressure, which would then solve for using some model of
subglacial hydrology.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="icepack.demo.04-ice-shelf-inverse.html" class="btn btn-neutral float-right" title="Inverse problems" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="icepack.demo.02-larsen-ice-shelf.html" class="btn btn-neutral float-left" title="Larsen Ice Shelf" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, Daniel Shapero

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>