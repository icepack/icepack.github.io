<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Ice streams, once more | icepack</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://icepack.github.io/notebooks/tutorials/06-hybrid-ice-stream/">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Daniel Shapero">
<meta property="og:site_name" content="icepack">
<meta property="og:title" content="Ice streams, once more">
<meta property="og:url" content="https://icepack.github.io/notebooks/tutorials/06-hybrid-ice-stream/">
<meta property="og:description" content="import tqdm
import matplotlib.pyplot as plt
import firedrake
import icepack, icepack.plot


    






Ice streams, once more¶In this demo, we'll revisit the ice stream demo but with a different model">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-10-23T12:44:36-07:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
        
    <header id="header"><h1 id="brand"><a href="../../../" title="icepack" rel="home">
        <img src="../../../images/logo.svg" alt="icepack" id="logo"></a></h1>

        

        
    <nav id="menu"><ul>
<li><a href="../../../">Home</a></li>
                <li><a href="../../../install/">Install</a></li>
                <li><a href="../../../tutorials/">Tutorials</a></li>
                <li><a href="../../../how-to/">How-to</a></li>
                <li><a href="../../../developers/">Development</a></li>
                <li><a href="../../../contact/">Contact</a></li>

    

    
    
    </ul></nav></header><main id="content"><article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header></header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tqdm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">firedrake</span>
<span class="kn">import</span> <span class="nn">icepack</span><span class="o">,</span> <span class="nn">icepack.plot</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ice-streams,-once-more">Ice streams, once more<a class="anchor-link" href="#Ice-streams,-once-more">¶</a>
</h2>
<p>In this demo, we'll revisit the ice stream demo but with a different model.
The <em>hybrid</em> flow model that we'll use here can resolve both <em>plug flow</em> and <em>shear flow</em>.
The velocity field is a plug flow if the velocity is roughly constanty with depth, whereas in shear flow the speed at the ice base is much smaller than at the ice surface.
Deep in the interior of an ice sheet, most flow is by vertical shear, whereas the fast ice streams near the margins are roughly in plug flow.
The shallow stream equations, and the <code>IceStream</code> class we used to solve them in the third demo, assume plug flow and thus are limited in the regions where they can be applied without substantial error.
The <code>HybridModel</code> class we'll use here has no such limitation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Geometry-and-input-data">Geometry and input data<a class="anchor-link" href="#Geometry-and-input-data">¶</a>
</h4>
<p>We'll use the same footprint geometry as the ice stream demo, but since we're working with a 3D flow model, we need a 3D mesh to go along with it.
The model we will use is posed entirely in <em>terrain-following coordinates</em>, where the $z$-axis is remapped into the interval $[0, 1]$.
This new coordinate is defined as</p>
$$\zeta = \frac{z - b}{h}$$<p>and the inverse transformation is $z = h\zeta + b$.
In the absence of terminus advance or iceberg calving, the transformation to this coordinate system makes the logical geometry of problem completely steady even though the surface can be rising or falling.</p>
<p>Firedrake includes built-in support generating <em>extruded meshes</em> out of a 2D footprint mesh.
Rather than use a large number of vertical layers to achieve high resolution of functions defined on this mesh, we'll use only one layer but high-degree basis functions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mf">50e3</span><span class="p">,</span> <span class="mf">12e3</span>
<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">RectangleMesh</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">ExtrudedMesh</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To define a function space on an extruded mesh, the only change over 2D function spaces is the addition of the <code>vfamily</code> and <code>vdegree</code> arguments.
These describe respectively the finite element type and polynomial degree in the vertical direction.
The surface and bed elevation only have to be defined on the footprint mesh, so we'll use vertical basis functions that are constant.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">FunctionSpace</span><span class="p">(</span>
    <span class="n">mesh</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">'CG'</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">vfamily</span><span class="o">=</span><span class="s1">'DG'</span><span class="p">,</span> <span class="n">vdegree</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The function space for the velocities is more interesting.
For starters, we have to explicitly specify the value dimension, since we're workin with a 2D vector field defined on a 3D mesh.
Rather than use the usual continuous or discontinuous Galerkin finite element bases in the vertical, we'll use <em>Gauss-Legendre</em> elements.
This finite element uses <a href="https://en.wikipedia.org/wiki/Legendre_polynomials">Legendre polynomials</a> instead of the Lagrange interpolating polynomials.
The Legendre polynomials are advantageous because they are mutually orthogonal.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">VectorFunctionSpace</span><span class="p">(</span>
    <span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">'CG'</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">vfamily</span><span class="o">=</span><span class="s1">'GL'</span><span class="p">,</span> <span class="n">vdegree</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creating the input data is mostly the same as before.
The <code>SpatialCoordinate</code> function now returns an additional symbol representing the terrain-following coordinate $\zeta$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">icepack.constants</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ice_density</span> <span class="k">as</span> <span class="n">ρ_I</span><span class="p">,</span>
    <span class="n">water_density</span> <span class="k">as</span> <span class="n">ρ_W</span><span class="p">,</span>
    <span class="n">weertman_sliding_law</span> <span class="k">as</span> <span class="n">m</span><span class="p">,</span>
    <span class="n">gravity</span> <span class="k">as</span> <span class="n">g</span>
<span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ζ</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b_in</span><span class="p">,</span> <span class="n">b_out</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">400</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">b_in</span> <span class="o">-</span> <span class="p">(</span><span class="n">b_in</span> <span class="o">-</span> <span class="n">b_out</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="n">s_in</span><span class="p">,</span> <span class="n">s_out</span> <span class="o">=</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">s0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">s_in</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_in</span> <span class="o">-</span> <span class="n">s_out</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="n">h0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">s0</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">h_in</span> <span class="o">=</span> <span class="n">s_in</span> <span class="o">-</span> <span class="n">b_in</span>
<span class="n">δs_δx</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_out</span> <span class="o">-</span> <span class="n">s_in</span><span class="p">)</span> <span class="o">/</span> <span class="n">Lx</span>
<span class="n">τ_D</span> <span class="o">=</span> <span class="o">-</span><span class="n">ρ_I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h_in</span> <span class="o">*</span> <span class="n">δs_δx</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u_in</span><span class="p">,</span> <span class="n">u_out</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2400</span>
<span class="n">velocity_x</span> <span class="o">=</span> <span class="n">u_in</span> <span class="o">+</span> <span class="p">(</span><span class="n">u_out</span> <span class="o">-</span> <span class="n">u_in</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">Lx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">firedrake</span><span class="o">.</span><span class="n">as_vector</span><span class="p">((</span><span class="n">velocity_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">V</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">255.0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">rate_factor</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.95</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">x</span><span class="o">/</span><span class="n">Lx</span><span class="p">)</span> <span class="o">*</span> <span class="n">τ_D</span> <span class="o">/</span> <span class="n">u_in</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>

<span class="n">p_W</span> <span class="o">=</span> <span class="n">ρ_W</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h0</span> <span class="o">-</span> <span class="n">s0</span><span class="p">)</span>
<span class="n">p_I</span> <span class="o">=</span> <span class="n">ρ_I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h0</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_W</span> <span class="o">/</span> <span class="n">p_I</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The bed friction can be re-parameterized for the hybrid model in the same way as for the ice stream model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">icepack.models.hybrid</span>
<span class="k">def</span> <span class="nf">friction</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">'velocity'</span><span class="p">]</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">'thickness'</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">'surface'</span><span class="p">]</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">'friction'</span><span class="p">]</span>
    
    <span class="n">p_W</span> <span class="o">=</span> <span class="n">ρ_W</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">p_I</span> <span class="o">=</span> <span class="n">ρ_I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h</span>
    <span class="n">ϕ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_W</span> <span class="o">/</span> <span class="n">p_I</span>
    <span class="k">return</span> <span class="n">icepack</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">hybrid</span><span class="o">.</span><span class="n">bed_friction</span><span class="p">(</span>
        <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> 
        <span class="n">friction</span><span class="o">=</span><span class="n">C</span> <span class="o">*</span> <span class="n">ϕ</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">HybridModel</span><span class="p">(</span><span class="n">friction</span><span class="o">=</span><span class="n">friction</span><span class="p">)</span>
<span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'dirichlet_ids'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'side_wall_ids'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">solvers</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>

<span class="n">u0</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
    <span class="n">velocity</span><span class="o">=</span><span class="n">u0</span><span class="p">,</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">h0</span><span class="p">,</span>
    <span class="n">surface</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span>
    <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span>
    <span class="n">friction</span><span class="o">=</span><span class="n">C</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>tricontourf</code> function in icepack will detect whether you're trying to plot a 2D or a 3D field.
Plotting 3D fields is expensive, so as a default, this function will depth-average the input field and make a contour plot of the resulting 2D field.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Modeling">Modeling<a class="anchor-link" href="#Modeling">¶</a>
</h4>
<p>The code to run the hybrid model is identical to that of the ice stream demo.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_years</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">timesteps_per_year</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">δt</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">timesteps_per_year</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="n">num_years</span> <span class="o">*</span> <span class="n">timesteps_per_year</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">1.7</span> <span class="o">-</span> <span class="mf">2.7</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">h0</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">u0</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">trange</span><span class="p">(</span><span class="n">num_timesteps</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">prognostic_solve</span><span class="p">(</span>
        <span class="n">δt</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
        <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
        <span class="n">accumulation</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
        <span class="n">thickness_inflow</span><span class="o">=</span><span class="n">h0</span>
    <span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">compute_surface</span><span class="p">(</span><span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">bed</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
        <span class="n">velocity</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
        <span class="n">surface</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
        <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span>
        <span class="n">friction</span><span class="o">=</span><span class="n">C</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 500/500 [18:03&lt;00:00,  2.17s/it]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a sanity check, we can plot the thickness, velocity, and mass balance.
These give very similar results in the eyeball norm to our previous demo assuming only plug flow.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span>  <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'meters'</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'meters/year'</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">div_2</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">div_2</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">u</span><span class="p">),</span> <span class="n">Q</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'RdBu'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'meters/year'</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">Lx</span> <span class="o">*</span> <span class="n">k</span> <span class="o">/</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

<span class="n">ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>
<span class="n">hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>
<span class="n">bs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">ss</span> <span class="o">-</span> <span class="n">hs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'distance along centerline (km)'</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'elevation (m)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">hs</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'distance along centerline (km)'</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'thickness (m)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Resolving-shear-flow">Resolving shear flow<a class="anchor-link" href="#Resolving-shear-flow">¶</a>
</h4>
<p>Unlike the ice stream model, however, the hybrid model can resolve vertical shear flow.
To quantity the degree to which the glacier is in plug flow vs shear flow, we can calculate a weighted depth average of the velocity.
In this case, we'll use the function</p>
$$q(\zeta) = \sqrt 3 \cdot (2\zeta - 1)$$<p>as our weight function.
This weight is odd when reflected over the axis $\zeta = 1/2$, so it's orthogonal to all plug flow fields.
The extra factor of $\sqrt 3$ is there to normalize the weight function so that</p>
$$\int_0^1q(\zeta)^2d\zeta = 1.$$<p>This weight is actually just the degree-1 Legendre polynomial, normalized and shifted over to the interval $[0, 1]$.</p>
<p>The function <code>depth_average</code> will evaluate a weighted depth average of a 3D field defined on an extruded mesh.
The weight can be any expression; in our case we're using a polynomial in the symbol $\zeta$, but we could also have used another finite element function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u_shear</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">depth_average</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ζ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting field is defined on the 2D footprint mesh as opposed to the 3D extruded mesh.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u_shear</span><span class="o">.</span><span class="n">ufl_domain</span><span class="p">()</span> <span class="ow">is</span> <span class="n">mesh2d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To wrap things up, let's plot the shear flow mode and do a bit of postprocessing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u_shear</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'meters/year'</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The region where the velocity has a significant shear flow component is confined to the left half of the domain, where the ice is grounded.
There is virtually no shear flow at all in the right half of the domain where the ice is floating, just as we expect.
To be more exact, we can also calculate the unweighted depth average of the velocity and take the ratio of the two components.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">firedrake</span> <span class="kn">import</span> <span class="n">inner</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="n">u_avg</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">depth_average</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

<span class="n">Q2D</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">'CG'</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U_shear</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">inner</span><span class="p">(</span><span class="n">u_shear</span><span class="p">,</span> <span class="n">u_shear</span><span class="p">))</span>
<span class="n">U_avg</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">inner</span><span class="p">(</span><span class="n">u_avg</span><span class="p">,</span> <span class="n">u_avg</span><span class="p">))</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">U_shear</span> <span class="o">/</span> <span class="n">U_avg</span><span class="p">,</span> <span class="n">Q2D</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The shear/plug ratio tops out at around 6\%.
For comparison, when the vertical velocity profile follows the shallow ice approximation, the horizontal velocity is a quartic polynomial in the vertical:</p>
$$u \propto 1 - (1 - \zeta)^4.$$<p>In this case, the shear/plug ratio can be calculated by hand to be $\frac{1}{2\sqrt3} \approx 29\%$.
We could arrive at a different shear ratio in steady state by using a larger value for the basal friction coefficient.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a>
</h4>
<p>In this demo, we showed how to use a hybrid model that can capture both plug and shear flow.
The biggest differences between this model and the ice stream model we showed earlier are that you need to create an extruded mesh and that you need to specify the element family and degree in the vertical dimension.
Using spectral methods in the vertical dimension makes it possible to capture much of the variation along this axis without resorting to a large number of layers, as might be necessary if we were using a more "traditional" discretization.
There are also a few extra steps when you want to analyze or plot 3D fields; depth averaging with a good choice of vertical weight function can get you pretty far.
In principle, this hybrid model will work well on much larger spatial scales such as an entire glacier drainage basin or even a whole ice sheet.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Epilogue:-bootstrapping">Epilogue: bootstrapping<a class="anchor-link" href="#Epilogue:-bootstrapping">¶</a>
</h4>
<p>When we chose a function space to represent the velocity field, we used a vertical degree of 1, which can resolve linear vertical variations.
Under the shallow ice approximation, the ice velocity is a quartic polynomial in $\zeta$, so using a degree of at least 4 might have been a more sensible choice.</p>
<p>The degree-1 solution can still be useful as a cheaper initial guess for the degree-4 solution.
We rarely have a good initial guess for what the steady-state velocity will be, and computing it from a cold start as we did for the degree-1 solution can be more expensive the more vertical modes we use.
Instead, we can run the degree-1 velocity and thickness to steady state and use this to initialize a (hopefully cheaper) degree-4 solution.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">V_1</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">VectorFunctionSpace</span><span class="p">(</span>
    <span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">'CG'</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">vfamily</span><span class="o">=</span><span class="s1">'GL'</span><span class="p">,</span> <span class="n">vdegree</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">u_1</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">V_1</span><span class="p">)</span>

<span class="n">V_4</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">VectorFunctionSpace</span><span class="p">(</span>
    <span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">'CG'</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">vfamily</span><span class="o">=</span><span class="s1">'GL'</span><span class="p">,</span> <span class="n">vdegree</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>
<span class="n">u_4</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">V_4</span><span class="p">)</span>

<span class="n">solver4</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">solvers</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">u_4</span> <span class="o">=</span> <span class="n">solver4</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span>
    <span class="n">velocity</span><span class="o">=</span><span class="n">u_4</span><span class="p">,</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
    <span class="n">surface</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
    <span class="n">fluidity</span><span class="o">=</span><span class="n">A</span><span class="p">,</span>
    <span class="n">friction</span><span class="o">=</span><span class="n">C</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Observe again how we had to create a new solver, which we called <code>solver4</code> here, to calculate the higher-degree velocity field.
The model object is the same because it's the same physics.
The solver changes because the solution we're looking for has more degrees of freedom, and thus the nonlinear system characterizing this solution is larger.</p>
<p>To see how much of a change we get with the extra vertical modes, we'll calculate the relative error in the 2-norm.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">δu</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">u_4</span> <span class="o">-</span> <span class="n">u_1</span><span class="p">,</span> <span class="n">V_4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">firedrake</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">δu</span><span class="p">)</span> <span class="o">/</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u_4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.032004930415379884
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A mismatch of only 3\% is not bad at all!
However, if we used a synthetic glacier that were closer to the idealized shallow ice approximation then the error would be larger.
The accuracy of the degree-1 solution in this particular case should not be extrapolated to all scenarios.</p>
<p>When we initialize the glacier from a rough initial guess as we did for the degree-1, we have to expect that it will take the entire residence time for any initial transients to propagate out, which in our case is in excess of 100 years.
If we initialize a degree-4 solution from the steady state degree-1 solution we may be able to get away with a much shorter spin-up period.</p>

</div>
</div>
</div>
</div>
    </div>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article></main>
</div>
    
            <script src="../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
