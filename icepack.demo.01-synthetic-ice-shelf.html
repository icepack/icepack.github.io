

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Synthetic ice shelf &mdash; icepack 0.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Larsen Ice Shelf" href="icepack.demo.02-larsen-ice-shelf.html" />
    <link rel="prev" title="Meshes, functions" href="icepack.demo.00-meshes-functions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> icepack
          

          
          </a>

          
            
            
              <div class="version">
                0.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading.html">Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.00-meshes-functions.html">Meshes, functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Synthetic ice shelf</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#geometry-and-input-data">Geometry and input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modeling">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.02-larsen-ice-shelf.html">Larsen Ice Shelf</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.03-synthetic-ice-stream.html">Synthetic ice stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.04-ice-shelf-inverse.html">Inverse problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.05-hybrid-ice-stream.html">Ice streams, once more</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">icepack</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">icepack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Synthetic ice shelf</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/icepack.demo.01-synthetic-ice-shelf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">firedrake</span>
<span class="kn">import</span> <span class="nn">icepack</span><span class="o">,</span> <span class="nn">icepack.plot</span><span class="o">,</span> <span class="nn">icepack.models</span>
</pre></div>
</div>
<div class="section" id="synthetic-ice-shelf">
<h1>Synthetic ice shelf<a class="headerlink" href="#synthetic-ice-shelf" title="Permalink to this headline">¶</a></h1>
<p>In this demo, we’ll show how to simulate the evolution of a floating ice
shelf. Running a simulation consists of creating a model object that
represents the physics you’re using, and calling the model object’s
solve methods. These methods take a set of input fields and return some
output field. For most ice sheet models, there are two kinds of PDEs to
solve: a diagnostic equation that takes in a thickness and returns the
current velocity, and a prognostic equation that takes the current
velocity and thickness, and returns the thickness at the next timestep.
To keep things as simple as possible, we’ll use an exact analytic
solution for the velocity of a floating ice shelf with a thickness that
decreases linearly from the inflow boundary to the ice front.</p>
<div class="section" id="geometry-and-input-data">
<h2>Geometry and input data<a class="headerlink" href="#geometry-and-input-data" title="Permalink to this headline">¶</a></h2>
<p>First we need to define some input data, for which we’ll use an exact
solution for a floating ice shelf with a simple geometry. A thorough
derivation of the PDE for ice shelf flow can be found in chapter 6 of
Greve and Blatter, <a class="reference external" href="https://books.google.com/books?isbn=3642034152">Dynamics of Ice Sheets and
Glaciers</a>, along with
the exact solution that we’ll use here. We’ll briefly review what these
PDEs are below. The symbols and variable names we use will correspond
exactly to the variable names used in the code that follows.</p>
<p>The diagnostic equation for the velocity of an ice shelf is</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot hM - \frac{1}{2}\varrho g\nabla h^2 = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the ice thickness, <span class="math notranslate nohighlight">\(M\)</span> is the membrane stress
tensor, <span class="math notranslate nohighlight">\(g\)</span> is the acceleration due to gravity, and
<span class="math notranslate nohighlight">\(\varrho = \rho_I(1 - \rho_I/\rho_W)\)</span> is the buoyant density of
ice over water. The membrane stress is defined as</p>
<div class="math notranslate nohighlight">
\[M = 2\mu(\dot\varepsilon + \text{tr}(\dot\varepsilon)I),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the ice viscosity,
<span class="math notranslate nohighlight">\(\dot\varepsilon = (\nabla u + \nabla u^*)/2\)</span> is the 2D
strain-rate tensor, and <span class="math notranslate nohighlight">\(I\)</span> is the identity tensor. Note that
since we’re in 2D the trace of the strain rate tensor is no longer zero.
Finally, the ice viscosity is a function of the strain rate tensor:</p>
<div class="math notranslate nohighlight">
\[\mu = \frac{B}{2}\sqrt{\frac{\dot\varepsilon : \dot\varepsilon + \text{tr}(\dot\varepsilon)^2}{2}}^{1/n - 1}\]</div>
<p>where <span class="math notranslate nohighlight">\(n = 3\)</span>, and <span class="math notranslate nohighlight">\(B\)</span> is the temperature-dependent rheology
coefficient.</p>
<p>When we consider ice shelves with no variation in the
<span class="math notranslate nohighlight">\(y\)</span>-direction, these equations reduce to a 1D boundary value
problem. We can integrate twice to get that</p>
<div class="math notranslate nohighlight">
\[u = u_0 + \int_0^x\left(\frac{\varrho g h(x')}{4B}\right)^n dx'.\]</div>
<p>When <span class="math notranslate nohighlight">\(h\)</span> is a linear function of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is
constant, we can evaluate this integral exactly to arrive at an
expression for <span class="math notranslate nohighlight">\(u\)</span> which is a degree-4 polynomial.</p>
<p>First, let’s set up the geometry and some function spaces.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mf">20e3</span><span class="p">,</span> <span class="mf">20e3</span>
<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">RectangleMesh</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="n">degree</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we’ll interpolate the expressions for the exact fields to the
finite element representation. This should all be familiar from the last
demo.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">icepack.constants</span> <span class="k">import</span> <span class="p">(</span><span class="n">ice_density</span> <span class="k">as</span> <span class="n">ρ_I</span><span class="p">,</span> <span class="n">water_density</span> <span class="k">as</span> <span class="n">ρ_W</span><span class="p">,</span>
                               <span class="n">gravity</span> <span class="k">as</span> <span class="n">g</span><span class="p">,</span> <span class="n">glen_flow_law</span> <span class="k">as</span> <span class="n">n</span><span class="p">)</span>

<span class="n">h0</span><span class="p">,</span> <span class="n">δh</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">100.0</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">h0</span> <span class="o">-</span> <span class="n">δh</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="n">ρ</span> <span class="o">=</span> <span class="n">ρ_I</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ρ_I</span> <span class="o">/</span> <span class="n">ρ_W</span><span class="p">)</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mf">254.15</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">rate_factor</span><span class="p">(</span><span class="n">T0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="n">ρ</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">h0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">B</span><span class="p">))</span><span class="o">**</span><span class="n">n</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">δh</span><span class="o">/</span><span class="n">h0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">Lx</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">u0</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">du</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="n">Lx</span> <span class="o">*</span> <span class="p">(</span><span class="n">h0</span> <span class="o">/</span> <span class="n">δh</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">firedrake</span><span class="o">.</span><span class="n">as_vector</span><span class="p">((</span><span class="n">u0</span> <span class="o">+</span> <span class="n">du</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we’ll plot both the thickness and the exact solution for the
velocity. Just to show off some of the matplotlib integration, we’ll
make them as subplots of the same figure. The extra padding around the
colorbars and the call to <code class="docutils literal notranslate"><span class="pre">fig.tight_layout()</span></code> are necessary for
things to look nice.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Thickness&#39;</span><span class="p">)</span>
<span class="n">contours_h</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours_h</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span>
<span class="n">contours_v</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours_v</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.01-synthetic-ice-shelf_7_0.png" src="_images/icepack.demo.01-synthetic-ice-shelf_7_0.png" />
</div>
<div class="section" id="modeling">
<h2>Modeling<a class="headerlink" href="#modeling" title="Permalink to this headline">¶</a></h2>
<p>To actually start solving things, we’ll make an <code class="docutils literal notranslate"><span class="pre">IceShelf</span></code> object that
represents the physical model we’re using. The model object stores a
bunch of data about the individual physics components – viscosity,
gravity, etc. These aren’t important for now but we’ll come back to them
later.</p>
<p>Each model type has two methods, <code class="docutils literal notranslate"><span class="pre">diagnostic_solve</span></code> and
<code class="docutils literal notranslate"><span class="pre">prognostic_solve</span></code>, that solve the PDEs for the ice velocity and
thickness.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ice_shelf</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">IceShelf</span><span class="p">()</span>
<span class="n">help</span><span class="p">(</span><span class="n">ice_shelf</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on method diagnostic_solve in module icepack.models.ice_shelf:

diagnostic_solve(u0, h, dirichlet_ids, tol=1e-06, <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs) method of icepack.models.ice_shelf.IceShelf instance
    Solve for the ice velocity from the thickness

    Parameters
    ----------
    u0 : firedrake.Function
        Initial guess for the ice velocity; the Dirichlet boundaries
        are taken from <cite>u0</cite>
    h : firedrake.Function
        Ice thickness
    dirichlet_ids : list of int
        list of integer IDs denoting the parts of the boundary where
        Dirichlet conditions should be applied
    tol : float
        dimensionless tolerance for when to terminate Newton's method

    Returns
    -------
    u : firedrake.Function
        Ice velocity

    Other parameters
    ----------------
    <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs
        All other keyword arguments will be passed on to the
        <cite>viscosity</cite> and <cite>gravity</cite> functions that were set when this
        model object was initialized</pre>
<p>To solve for the ice velocity, we pass in all the input fields as
keyword arguments. To make things a little more interesting, we’ll use a
value of the fluidity parameter that changes in the center of the
domain. Since we’re using a value of the fluidity parameter that varies
in both the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-directions, the PDE will no longer
have a nice closed-form solution.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">Lx</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="n">Ly</span>
<span class="n">shape_x</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">px</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">px</span><span class="p">))</span>
<span class="n">shape_y</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">max_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">py</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">py</span><span class="p">))</span>

<span class="n">δT</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">+</span> <span class="n">shape_x</span> <span class="o">*</span> <span class="n">shape_y</span> <span class="o">*</span> <span class="n">δT</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">icepack</span><span class="o">.</span><span class="n">rate_factor</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Q</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;MPa$</span><span class="si">{}</span><span class="s1">^{-3}$ * years$</span><span class="si">{}</span><span class="s1">^{-1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.01-synthetic-ice-shelf_11_0.png" src="_images/icepack.demo.01-synthetic-ice-shelf_11_0.png" />
<p>We also need to describe the boundary conditions we’re using and the
tolerance for solving Newton’s method. Since the boundary conditions and
convergence tolerance are usually the same throughout a simulation,
we’ll pack them into a dictionary and reuse it throughout. To compute
the velocity field that results from the values of the thickness and
fluidity we’ve chosen, we invoke the diagnostic solve method of the ice
shelf object, passing in the extra options as keyword arguments.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dirichlet_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="mf">1e-12</span><span class="p">}</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">ice_shelf</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span><span class="n">u0</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
</pre></div>
</div>
<p>Note how in the diagnostic solve procedure we passed everything in as a
keyword argument. This convention will be used throughout all the demos.
Keyword arguments are slightly more verbose, but they save you the
trouble of remembering what order everything goes in. On top of that,
many fields are <em>only</em> passed in as keyword arguments; for example, the
fluidity parameter is not a positional argument of the diagnostic solve
routine. The reason for this choice, as we’ll see later, is that it’s
much easier to swap out components of the model physics for your own
customized versions.</p>
<p>The effect of using a different fluidity field can be seen in how the
contour lines for the ice speed bend in the middle of the domain.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.01-synthetic-ice-shelf_16_0.png" src="_images/icepack.demo.01-synthetic-ice-shelf_16_0.png" />
<p>To project the state of the ice shelf forward in time, we’ll use the
prognostic solve method. The prognostic solver updates the ice thickness
forward by a given timestep given the accumulation rate and velocity. We
then update the velocity using the diagnostic solver at each timestep.
The following code runs the model forward for a year with a timestep of
one month, assuming a constant value of the accumulation rate.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">num_timesteps</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">firedrake</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">firedrake</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="n">Q</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_timesteps</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">ice_shelf</span><span class="o">.</span><span class="n">prognostic_solve</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">h0</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">ice_shelf</span><span class="o">.</span><span class="n">diagnostic_solve</span><span class="p">(</span><span class="n">u0</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.01-synthetic-ice-shelf_19_0.png" src="_images/icepack.demo.01-synthetic-ice-shelf_19_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">icepack</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;meters/year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/icepack.demo.01-synthetic-ice-shelf_20_0.png" src="_images/icepack.demo.01-synthetic-ice-shelf_20_0.png" />
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>In the last demo, we saw how to create a mesh, define a finite element
space, interpolate functions to that finite element space, and analyze
the results through either plotting or more general post-processing.
Here we’ve shown how to use these functions as an input to an ice shelf
flow model. There are a lot of interesting experiments you can do with
synthetic ice shelves. For example, you can approximate the effect of
seasonality by making the accumulation rate and inflow thickness a
sinusoidal function of time. You can then add things like tidal effects
and see how they alter the overall ice flow. In the next demo, we’ll
show how to use these functions for simulating a real ice shelf using
observational data.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="icepack.demo.02-larsen-ice-shelf.html" class="btn btn-neutral float-right" title="Larsen Ice Shelf" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="icepack.demo.00-meshes-functions.html" class="btn btn-neutral float-left" title="Meshes, functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Daniel Shapero

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>