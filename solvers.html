

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Physics solvers &mdash; icepack 0.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Inverse solvers" href="inverse.html" />
    <link rel="prev" title="Design" href="design.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> icepack
          

          
          </a>

          
            
            
              <div class="version">
                0.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.00-meshes-functions.html">Meshes, functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.01-synthetic-ice-shelf.html">Synthetic ice shelf</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.02-larsen-ice-shelf.html">Larsen Ice Shelf</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.03-synthetic-ice-stream.html">Synthetic ice stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.04-ice-shelf-inverse.html">Inverse problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="icepack.demo.05-hybrid-ice-stream.html">Ice streams, once more</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="design.html">Design</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Physics solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="inverse.html">Inverse solvers</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">icepack</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">icepack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="design.html">Design</a> &raquo;</li>
        
      <li>Physics solvers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/solvers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="physics-solvers">
<h1>Physics solvers<a class="headerlink" href="#physics-solvers" title="Permalink to this headline">¶</a></h1>
<p>The solver for the diagnostic equations of glacier flow is one of the most important components of icepack.
Since ice is shear-thinning, the elliptic PDE for the ice velocity is nonlinear.
The diagnostic equations, however, are actually the derivative of a nonlinear scalar functional, the <em>action</em>.
Moreover, the action functionals for most glacier models are convex, so the velocity is the unique minimizer.
We can exploit this special structure to define nonlinear solvers that require less hand-tuning than a solver for an arbitrary nonlinear system of equations would.</p>
<p>Let <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(h\)</span> be the ice velocity and thickness respectively.
The <em>strain rate tensor</em> is the symmetrized gradient of the ice velocity:</p>
<div class="math notranslate nohighlight">
\[\dot\varepsilon = \frac{1}{2}\left(\nabla u + \nabla u^\top\right)\]</div>
<p>The <em>membrane stress tensor</em> <span class="math notranslate nohighlight">\(M\)</span> represents the traction around an infinitesimal area element.
It is defined in terms of the the strain rate:</p>
<div class="math notranslate nohighlight">
\[M = 2\mu(\dot\varepsilon + \text{tr}(\dot\varepsilon)\cdot I)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the ice viscosity.
The shallow shelf equations are:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot hM - \frac{1}{2}\varrho g\nabla h^2 = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(\varrho\)</span> is the reduced density of ice over seawater and <span class="math notranslate nohighlight">\(g\)</span> is the acceleration due to gravity.</p>
<p>The <em>action functional</em> for the shallow shelf equations is:</p>
<div class="math notranslate nohighlight">
\[E(u) = \int_\Omega\left(\frac{n}{n + 1}h M : \dot\varepsilon - \frac{1}{2}\varrho gh^2\nabla\cdot u\right)dx.\]</div>
<p>Using the usual methods of the variational calculus, one can show that the shallow shelf equations are the functional derivative of <span class="math notranslate nohighlight">\(E\)</span>.
Moreover, with a bit more calcuation, one can also show that <span class="math notranslate nohighlight">\(E\)</span> is <em>convex</em> – the second derivative is positive-definite.
This means that it has a unique minimizer.</p>
<p>Since the solution of the shallow shelf equations minimizes the action, we can make a convergence criterion for our solver based on the value of the action rather than on, say, the norm of the residual.
Internally, icepack uses Newton’s method to solve the minimization problem:</p>
<div class="math notranslate nohighlight">
\[u_{k + 1} = u_k - d^2E(u_k)^{-1}dE(u_k).\]</div>
<p>The <em>Newton decrement</em> is the quantity</p>
<div class="math notranslate nohighlight">
\[\Delta = \frac{1}{2}\langle dE(u_k), d^2E(u_k)^{-1}dE(u_k)\rangle.\]</div>
<p>The Newton decrement is always positive, and it approximates the difference between the current value of the action functional and the minimum value.
By evaluating the ratio of the Newton decrement to that of some positive scale functional – in icepack we use just the first term of the action – we can get a dimensionless measure of how much relative improvement there is to be had by doing one more iteration of Newton’s method.
When this ratio is sufficiently small, the iteration has converged.
Empirically, I’ve found that even with a very small tolerances like 10<sup>-12</sup> the method converges in 8-10 iterations.</p>
<p>The nice part about setting a convergence tolerance this way is that the action is an “objective” quantity – whether you use finite element methods or finite volume methods, piecewise linear or quadratic basis functions, etc., you’re always computing the same thing.
The 2-norm of the residual, however, depends on how you discretize the problem.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="inverse.html" class="btn btn-neutral float-right" title="Inverse solvers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="design.html" class="btn btn-neutral float-left" title="Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Daniel Shapero

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>